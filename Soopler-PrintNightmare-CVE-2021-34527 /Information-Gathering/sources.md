# ðŸ“Œ Information Sources for CVE Research

This file contains references to various **trusted sources** used for investigating CVE-2021-34527 (PrintNightmare).  
Each section corresponds to a security organization or platform, followed by its URL and a summary of key insights.  

---

# ðŸ”¹ **Official CVE & Security Databases**

## ðŸ”— [CVE.org](https://www.cve.org/CVERecord?id=CVE-2021-34527)  
**Findings:**  
CVE-2021-34527 (PrintNightmare) is a **remote code execution (RCE) vulnerability** in the **Windows Print Spooler service**.  

### **Key Details:**
- **Type of Vulnerability**: Remote Code Execution (RCE)  
- **Attack Impact**: SYSTEM-level privilege escalation, full system compromise.  
- **Affected Windows Versions**:  
  - Windows 10 (1809, 20H2, 21H2, 22H2)  
  - Windows Server (2012, 2016, 2019, 2022)  
  - Windows 8.1, Windows 11 (21H2, 22H2)  
- **Patch Available?** âœ… Yes, via **KB5005010**  

### **Registry Settings for Protection:**
```
HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint
NoWarningNoElevationOnInstall = 0 (DWORD) or not defined
UpdatePromptSettings = 0 (DWORD) or not defined
Setting NoWarningNoElevationOnInstall = 1 makes the system vulnerable.
```
### **CVSS Score Explanation:**
- **Score**: 8.8 (High)
- **Vector String**: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C
- **Impact**: Exploitable remotely, requires low privileges, leads to full system compromise.
- **References & Related CVEs**
- [**Microsoft Advisory: MSRC Advisory**](https://msrc.microsoft.com/update-guide/en-US/advisory/CVE-2021-34527)
- [**Patch KB Number**: KB5005010](https://support.microsoft.com/en-us/topic/kb5005010-restricting-installation-of-new-printer-drivers-after-applying-the-july-6-2021-updates-31b91c02-05bc-4ada-a7ea-183b129578a7)
- **Related CVE**: CVE-2021-1675

## ðŸ”— [NVD (National Vulnerability Database)](https://nvd.nist.gov/vuln/detail/CVE-2021-34527)  
**Findings:**  
### **Exploit & Mitigation References:**
- **Exploit Code:**  
  - [Print Spooler Remote DLL Injection (Packet Storm Security)](http://packetstormsecurity.com/files/167261/Print-Spooler-Remote-DLL-Injection.html)  
- **Microsoft Patch & Vendor Advisory:**  
  - [MSRC Advisory](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-34527)
 
  ### **CISA KEV & Known Exploited Vulnerabilities:**  
- **CVE-2021-34527** is included in **[CISAâ€™s Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/news-events/alerts/2021/06/30/printnightmare-critical-windows-print-spooler-vulnerability)**
- [**BOD-22-01**](https://www.cisa.gov/news-events/directives/bod-22-01-reducing-significant-risk-known-exploited-vulnerabilities)

- ### **Affected Software Configurations:**  
NVD tracks affected Windows versions using **CPE identifiers** (Common Platform Enumeration). The following Windows versions were vulnerable **before updates were applied**:

| **Windows Version** | **Affected Before Version** |
|---------------------|---------------------------|
| Windows 10 (1507) | 10.0.10240.18969 |
| Windows 10 (1607) | 10.0.14393.4470 |
| Windows 10 (1809) | 10.0.17763.2029 |
| Windows 10 (20H2) | 10.0.19042.1083 |
| Windows 10 (21H2) | 10.0.19044.1415 |
| Windows 10 (22H2) | 10.0.19045.2251 |
| Windows 11 (21H2) | 10.0.22000.318 |
| Windows 11 (22H2) | 10.0.22621.674 |
| Windows 7 SP1 | All versions |
| Windows 8.1 | All versions |
| Windows Server 2008, 2012, 2016, 2019, 2022 | Various builds before patching |

ðŸ“Œ **Note:** Any system running an **unpatched** version of Windows **before these builds** remains vulnerable.


## ðŸ”— [Microsoft Security Response Center (MSRC)](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527)  
**Findings:** 
### Security Vulnerability
- **Released:** July 1, 2021
- **Last Updated:** June 13, 2023
- **Assigning CNA:** Microsoft
- **CVE.org Link:** [CVE-2021-34527](https://cve.org/CVERecord?id=CVE-2021-34527)
- **Impact:** Remote Code Execution
- **Max Severity:** Critical
- **Vector String:** CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:C
- **Metrics:** CVSS:3.0 8.8 / 8.2

### Executive Summary
A remote code execution vulnerability exists in the Windows Print Spooler service due to improper handling of privileged file operations. Exploiting this vulnerability allows an attacker to execute arbitrary code with SYSTEM privileges. This can lead to:
- Installing malicious programs
- Viewing, modifying, or deleting sensitive data
- Creating new accounts with full user privileges

### **Security Updates**
- **July 7, 2021:** Security updates released for Windows Server 2012, Windows Server 2016, and Windows 10 Version 1607. Users should install updates immediately.
- **July 6, 2021:** Microsoft released security updates to address this vulnerability, which also include protections for **CVE-2021-1675** (PrintNightmare).

### **Registry Mitigation**
Ensure the following registry settings are set to `0` (zero) or not defined:
```
HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint
NoWarningNoElevationOnInstall = 0 (DWORD) or not defined (default setting)
UpdatePromptSettings = 0 (DWORD) or not defined (default setting)
```
> **Warning:** Setting `NoWarningNoElevationOnInstall` to `1` makes your system vulnerable.

### **Exploitability**
| Publicly Disclosed | Exploited | Exploitability Assessment |
|--------------------|----------|--------------------------|
| Yes | Yes | Exploitation Detected |

### **Workarounds**
### **Determine if the Print Spooler Service is Running**
Run the following command in PowerShell:
```powershell
Get-Service -Name Spooler
```
If the service is running, use one of the following options:

### **Option 1 - Disable the Print Spooler Service**
```powershell
Stop-Service -Name Spooler -Force
Set-Service -Name Spooler -StartupType Disabled
```
**Impact:** Disables both local and remote printing.

### **Option 2 - Disable Inbound Remote Printing via Group Policy**
Configure Group Policy:
```
Computer Configuration / Administrative Templates / Printers
Disable the "Allow Print Spooler to accept client connections:" policy
```
Restart the Print Spooler service for the policy to take effect.

**Impact:** Blocks remote printing attacks but allows local printing.

### **References**
- [Microsoft Security Update](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527)
- [KB5005010: Restricting installation of new printer drivers](https://support.microsoft.com/en-us/topic/kb5005010-restricting-installation-of-new-printer-drivers-after-applying-the-july-6-2021-updates-6dcdb330-1a3e-7e51-21a1-5f73d0b70477)
- [PrintNightmare Advisory](https://cve.org/CVERecord?id=CVE-2021-34527)


## ðŸ”— [CISA Known Exploited Vulnerabilities (KEV)](https://www.cisa.gov/known-exploited-vulnerabilities-catalog)  
**Findings:**  
# CVE-2021-34527: PrintNightmare - Windows Print Spooler Vulnerability

### Overview
CVE-2021-34527, commonly known as **PrintNightmare**, vulnerability in the **Windows Print Spooler** service. This vulnerability arises due to improper handling of privileged file operations, allowing attackers to execute arbitrary code with **SYSTEM** privileges.

- **CVE ID:** CVE-2021-34527
- **CWE ID:** [CWE-269](https://cwe.mitre.org/data/definitions/269.html) (Improper Privilege Management)
- **Impact:** Remote Code Execution (RCE) with SYSTEM privileges
- **Exploitation:** Actively used in ransomware campaigns
- **Recommended Action:** Apply Microsoft updates or disable the Print Spooler service where necessary

### Timeline & Key Developments
#### Initial Discovery & Mitigations
- **June 30, 2021:** CERT Coordination Center ([CERT/CC](https://www.kb.cert.org)) released a [VulNote](https://www.kb.cert.org/vuls/id/383432) highlighting the vulnerability.
- **July 1, 2021:** Microsoft issued initial guidance, recommending workarounds for unpatched systems.
- **July 2, 2021:** Microsoft revised its mitigation strategies, advising administrators to **disable the Print Spooler service** on Domain Controllers and non-essential systems.

#### CISAâ€™s Emergency Directive (ED 21-04)
- **January 25, 2022:** The **Cybersecurity and Infrastructure Security Agency (CISA)** issued [Emergency Directive ED 21-04](https://www.cisa.gov/news-events/directives/ed-21-04-mitigate-windows-print-spooler-service-vulnerability).
  - Federal agencies were **required to apply Microsoftâ€™s July 2021 security updates** and **disable the Print Spooler service** on **Active Directory (AD) Domain Controllers**.
  - CISA urged state and local governments, as well as private sector organizations, to review and implement these mitigation strategies.

### Microsoftâ€™s Security Updates & Limitations
- Microsoft released **out-of-band security updates** for **CVE-2021-34527** that also include protections for **CVE-2021-1675**.
- Updates were cumulative but **did not** initially cover:
  - **Windows 10 Version 1607**
  - **Windows Server 2012**
  - **Windows Server 2016**
- According to **CERT/CC**, Microsoft's patch only addressed **RCE via SMB and RPC**, but **not** the **Local Privilege Escalation (LPE) variant**.
  - For workarounds, see [CERT/CC Vulnerability Note VU #383432](https://www.kb.cert.org/vuls/id/383432).

### Recommended Actions
1. **Apply Microsoft Security Updates** as per [Microsoftâ€™s official guidance](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527).
2. **Disable the Print Spooler service** on:
   - Domain Controllers (DCs)
   - Non-printing critical systems
   - Active Directory (AD) admin workstations
3. **Implement Group Policy Objects (GPO)** to enforce print spooler restrictions.
4. **Monitor and mitigate threats** using **CISA and CERT/CC recommendations**.


## ðŸ”— [CWE (MITRE)](https://cwe.mitre.org/data/definitions/269.html)  
**Findings:**  
- Links this CVE to relevant CWE categories:  
  - **CWE-269:** Improper Privilege Management.  
  - **CWE-284:** Improper Access Control.  
- Helps understand **root cause classification**.  

---

## ðŸ”¹ **Security Research & Threat Intelligence**

## ðŸ”— [Huntress Security Blog](https://www.huntress.com/blog)  
**Findings:**  
- In-depth research articles on PrintNightmare.  
- Includes exploit analysis, detection techniques, and mitigations.  
- Great for **learning how security researchers analyze CVEs**.

- ## ðŸ”— [CERT/CC Vulnerability Notes Database](https://www.kb.cert.org/vuls/)  
**Findings:**  
- In-depth research articles on PrintNightmare.  
- Includes exploit analysis, detection techniques, and mitigations.  
- Great for **learning how security researchers analyze CVEs**. 

## ðŸ”— [Rapid7 Vulnerability Research](https://www.rapid7.com/blog/)  
**Findings:**  
- Rapid7â€™s deep dive into PrintNightmare exploitation and detection.  
- Discusses Metasploit integration and attack surface analysis.  
- Important for **understanding attacker methodologies**.  

## ðŸ”— [Mandiant Threat Intelligence](https://www.mandiant.com/resources/blog)  
**Findings:**  
- Tracks APT groups exploiting PrintNightmare.  
- Provides forensic insights and detection techniques.  
- Crucial for **APT analysis and real-world case studies**.  

## ðŸ”— [The DFIR Report](https://thedfirreport.com/)  
**Findings:**  
- Breaks down real-world incidents where PrintNightmare was used.  
- Provides attack timelines, adversary techniques, and detection tips.  
- Great for **seeing real-world exploitation cases in action**.  

## ðŸ”— [ResearchGate Security Papers](https://www.researchgate.net/)  
**Findings:**  
- Hosts academic research papers on Windows vulnerabilities.  
- Provides theoretical insights and deep technical analysis.  
- Ideal for **learning about fundamental security concepts**.  

---

## ðŸ”¹ **Exploit Repositories & Offensive Security**

## ðŸ”— [GitHub Security PoCs](https://github.com/search?q=CVE-2021-34527)  
**Findings:**  
- Contains multiple proof-of-concept (PoC) exploit codes.  
- Community-driven repositories with attack execution steps.  
- Useful for **finding working exploits and adapting them**.  

## ðŸ”— [Exploit Database (Exploit-DB)](https://www.exploit-db.com/exploits/50063)  
**Findings:**  
- Contains publicly disclosed exploit code for PrintNightmare.  
- Useful for **analyzing different exploitation methods**.  

## ðŸ”— [Packet Storm Security](https://packetstormsecurity.com/files/cve/CVE-2021-34527)  
**Findings:**  
- Provides exploit scripts and alternative attack techniques.  
- Archives various PoCs and offensive security tools.  
- Helpful for **understanding attack variations**.  

## ðŸ”— **Metasploit Modules**  
**Findings:**  
- PrintNightmare exploitation is included in Metasploit.  
- Automates privilege escalation and remote execution.  
- Important for **pentesting and security testing labs**.  

---

## ðŸ“Œ **Additional Resources for Future Research** (No URLs, but useful references)  

- **Mandiant (APT reports & intelligence)**  
- **ResearchGate (Security research papers)**  
- **The DFIR Report (Incident response case studies)**  
